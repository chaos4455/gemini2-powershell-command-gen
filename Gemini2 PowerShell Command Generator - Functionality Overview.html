<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.8/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.8/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.8/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:x,mm:K}=window,P=new x.Toolbar;P.attach(K);const F=P.render();F.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(F)})})()</script><script>((b,L,T,D)=>{const H=b();window.mm=H.Markmap.create("svg#mindmap",(L||H.deriveOptions)(D),T)})(()=>window.markmap,null,{"content":"ğŸ¤– Gemini2 PowerShell Command Generator - Functionality Overview","children":[{"content":"ğŸš€ Application Goal","children":[{"content":"<strong>Purpose:</strong>  To generate PowerShell commands using Google's Gemini AI, tailored to user needs.","children":[],"payload":{"tag":"li","lines":"7,9"}}],"payload":{"tag":"h1","lines":"6,7"}},{"content":"âš™ï¸ Setup &amp; Configuration","children":[{"content":"<strong>API Key Handling ğŸ”‘</strong>:","children":[{"content":"Securely retrieves the Google Gemini API key.","children":[],"payload":{"tag":"li","lines":"11,12"}},{"content":"Prevents direct exposure of credentials in the code.","children":[],"payload":{"tag":"li","lines":"12,13"}}],"payload":{"tag":"li","lines":"10,13"}},{"content":"<strong>Streamlit Page Setup ğŸ–¥ï¸</strong>:","children":[{"content":"Sets the page title, icon (ğŸ¤–), and layout (wide).","children":[],"payload":{"tag":"li","lines":"14,15"}},{"content":"Provides a user-friendly, full-width experience.","children":[],"payload":{"tag":"li","lines":"15,17"}}],"payload":{"tag":"li","lines":"13,17"}}],"payload":{"tag":"h1","lines":"9,10"}},{"content":"ğŸ§  Core Functionalities","children":[{"content":"ğŸ—£ï¸ AI Communication","children":[{"content":"<strong><code>send_message_to_model</code> Function âœ‰ï¸</strong>:<br>\n- Sends prompts to the Gemini AI model.<br>\n- Receives the AI's text responses.<br>\n-   Handles API communication safely (try-except block).<br>\n-   Configures AI parameters: temperature (creativityğŸŒ¡ï¸), token limitsğŸ“, etc.<br>\n- Manages the AI's chat session ğŸ’¬ (start and send message).<br>\n-   Reports errors âŒ if AI communication fails.","children":[],"payload":{"tag":"li","lines":"21,29"}}],"payload":{"tag":"h2","lines":"19,20"}},{"content":"âœ¨ PowerShell Command Generation","children":[{"content":"<strong><code>generate_powershell_command</code> Function ğŸ› ï¸</strong>:","children":[{"content":"Takes user settings to craft a very detailed prompt.","children":[],"payload":{"tag":"li","lines":"32,33"}},{"content":"Sends the detailed prompt to the AI (via <code>send_message_to_model</code>).","children":[],"payload":{"tag":"li","lines":"33,34"}},{"content":"AI generates PowerShell code based on specific requests and settings.<br>\n- The prompt acts as a very detailed instruction manual to the AI<br>\n- Defines the AI role as a powershell expert.<br>\n- Guides the AI in the process of generating the code.<br>\n- Defines the format of the AI response.<br>\n- Specifies the use of advanced powershell resources.<br>\n- Specifies the default operational system and powershell version.<br>\n- Specifies the security level and error handling that should be implemented.<br>\n-  Requests the largest and most complete code possible.<br>\n- Requests the use of incremental reasoning.","children":[],"payload":{"tag":"li","lines":"34,44"}},{"content":"Returns the generated code.","children":[],"payload":{"tag":"li","lines":"44,46"}}],"payload":{"tag":"li","lines":"31,46"}}],"payload":{"tag":"h2","lines":"29,30"}},{"content":"ğŸ’¾ PowerShell Code Handling","children":[{"content":"<strong><code>parse_and_save_ps1</code> Function ğŸ“„</strong>:<br>\n-   Takes the AI's Markdown response and extracts the PowerShell code.<br>\n-  Cleans and prepares the extracted code<br>\n-  Constructs a filename for the .ps1 file.<br>\n- If selected, add an autogenerated header to the file.<br>\n-   Saves the extracted code to a <code>.ps1</code> file ğŸ’¾.<br>\n-   Returns the file name and extracted code.","children":[],"payload":{"tag":"li","lines":"48,56"}}],"payload":{"tag":"h2","lines":"46,47"}}],"payload":{"tag":"h1","lines":"17,18"}},{"content":"ğŸ›ï¸ Main Application Logic","children":[{"content":"ğŸ–¥ï¸ UI Setup","children":[{"content":"<strong>Title &amp; Introduction ğŸ“</strong>:","children":[{"content":"Displays the app's title and purpose.","children":[],"payload":{"tag":"li","lines":"61,62"}}],"payload":{"tag":"li","lines":"60,62"}},{"content":"<strong>Layout Setup â†”ï¸</strong>:","children":[{"content":"Creates a two-column layout for better organization:","children":[{"content":"Settings on the left.","children":[],"payload":{"tag":"li","lines":"64,65"}},{"content":"Main content on the right.","children":[],"payload":{"tag":"li","lines":"65,67"}}],"payload":{"tag":"li","lines":"63,67"}}],"payload":{"tag":"li","lines":"62,67"}}],"payload":{"tag":"h2","lines":"58,59"}},{"content":"âš™ï¸ User Settings (Sidebar)","children":[{"content":"<strong>Settings Header âš™ï¸</strong>:<br>\n- Groups configuration elements","children":[],"payload":{"tag":"li","lines":"69,71"}},{"content":"<strong>AI Settings ğŸ¤–</strong>:","children":[{"content":"Allows users to select AI model ğŸ¤–, temperature ğŸŒ¡ï¸, and token limit ğŸ“.","children":[],"payload":{"tag":"li","lines":"72,73"}}],"payload":{"tag":"li","lines":"71,73"}},{"content":"<strong>Prompt Settings ğŸ“</strong>:","children":[{"content":"Allows user to select preset prompts ğŸ¯ and prompt detail level ğŸ§","children":[],"payload":{"tag":"li","lines":"74,75"}}],"payload":{"tag":"li","lines":"73,75"}},{"content":"<strong>PowerShell Settings ğŸ› ï¸</strong>:","children":[{"content":"Allows users to select:","children":[{"content":"PowerShell version ğŸ›ï¸.","children":[],"payload":{"tag":"li","lines":"77,78"}},{"content":"Target OS ğŸ’».","children":[],"payload":{"tag":"li","lines":"78,79"}},{"content":"File encoding ğŸ”¤.","children":[],"payload":{"tag":"li","lines":"79,80"}},{"content":"Add a header ğŸ“œ.","children":[],"payload":{"tag":"li","lines":"80,81"}},{"content":"Add error handling ğŸ›¡ï¸.","children":[],"payload":{"tag":"li","lines":"81,82"}},{"content":"Logging level ğŸ—‚ï¸","children":[],"payload":{"tag":"li","lines":"82,83"}},{"content":"Code detail level","children":[],"payload":{"tag":"li","lines":"83,84"}},{"content":"Script type (automatic or interactive)","children":[],"payload":{"tag":"li","lines":"84,85"}},{"content":"Security level (High, Medium, Low)","children":[],"payload":{"tag":"li","lines":"85,87"}}],"payload":{"tag":"li","lines":"76,87"}}],"payload":{"tag":"li","lines":"75,87"}}],"payload":{"tag":"h2","lines":"67,68"}},{"content":"ğŸ—‚ï¸ Main Content Area","children":[{"content":"<pre data-lines=\"90,92\"><code>- **Preset Prompt ğŸ¯**:\n    - If the user selects a predefined prompt, updates the command description with the selected prompt.\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"90,92"}}],"payload":{"tag":"h2","lines":"87,88"}},{"content":"ğŸ›¡ï¸ Execution Guard","children":[{"content":"<pre data-lines=\"106,107\"><code>- Ensures that the main function runs only when the script is the main program being executed.\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"106,107"}}],"payload":{"tag":"h2","lines":"105,106"}}],"payload":{"tag":"h1","lines":"56,57"}},{"content":"ğŸ Execution","children":[{"content":"Starts the Streamlit app by calling the <code>main()</code> function.","children":[],"payload":{"tag":"li","lines":"109,110"}}],"payload":{"tag":"h1","lines":"108,109"}}]},{"colorFreezeLevel":2})</script>
</body>
</html>
